# Epoch-Based Training

การเทรนโมเดลแบบ Epoch-Based เป็นวิธีการเทรนพื้นฐานที่สุด โดยใช้ข้อมูลทั้งหมดในแต่ละรอบ (epoch) ในการอัพเดทพารามิเตอร์ของโมเดล

## แนวคิด

- เทรนโมเดลโดยวนผ่าน dataset ทั้งชุดหลายรอบ (epoch)
- ใช้ข้อมูลทั้งหมดในแต่ละ epoch ในการคำนวณ gradient
- อัพเดทพารามิเตอร์หลังจากประมวลผลข้อมูลทั้งหมด

## วิธีการทำงาน

1. กำหนดจำนวน epoch (เช่น 10, 50, 100)
2. ในแต่ละ epoch:
   - ใช้ข้อมูลทั้งหมดในการคำนวณการทำนาย
   - คำนวณค่าความสูญเสีย (MSE)
   - คำนวณ gradient
   - อัพเดทพารามิเตอร์ (weights และ bias)
3. ทำซ้ำจนครบจำนวน epoch ที่กำหนด

## เครื่องมือที่ใช้

- Python
- PyTorch สำหรับการคำนวณ gradient และการเทรน
- NumPy สำหรับการจัดการข้อมูล
- Matplotlib สำหรับการแสดงผล

## จุดเด่น

1. ควบคุมได้ง่าย
   - กำหนดจำนวน epochs ที่ต้องการได้
   - เห็นภาพรวมของข้อมูลในแต่ละรอบ

2. เป็นพื้นฐานที่สุด
   - ใช้ข้อมูลทั้งหมดในแต่ละ epoch
   - ไม่ต้องจัดการเรื่อง batch หรือ mini-batch

3. เห็นภาพรวมของข้อมูล
   - เรียนรู้จากข้อมูลทั้งหมดในแต่ละรอบ
   - เหมาะกับชุดข้อมูลขนาดเล็ก

## ข้อจำกัด

1. อาจเทรนมากเกินไป (overfitting)
   - ต้องเลือกจำนวน epochs ที่เหมาะสม
   - อาจต้องใช้ early stopping

2. ใช้เวลานาน
   - ต้องประมวลผลข้อมูลทั้งหมดในแต่ละ epoch
   - ไม่เหมาะกับชุดข้อมูลขนาดใหญ่

3. ใช้หน่วยความจำมาก
   - ต้องเก็บข้อมูลทั้งหมดไว้ในหน่วยความจำ
   - อาจมีปัญหาเมื่อข้อมูลมีขนาดใหญ่

## การใช้งาน

1. ติดตั้ง dependencies:
```bash
pip install -r requirements.txt
```

2. รันการสาธิต:
```bash
python run_demo.py
```

3. ดูผลลัพธ์:
   - กราฟประวัติค่าความสูญเสีย: `./plots/epoch_based_loss_history.png`
   - ภาพข้อมูลและเส้นถดถอย: `./plots/epoch_based_regression.png`
   - ข้อมูล: `./data/epoch_based_dataset.npz`

## พารามิเตอร์

- `learning_rate`: อัตราการเรียนรู้ (ค่าเริ่มต้น: 0.1)
- `epochs`: จำนวนรอบในการเทรน (ค่าเริ่มต้น: 50)
- `n_samples`: จำนวนตัวอย่างในชุดข้อมูล (ค่าเริ่มต้น: 100)
- `n_features`: จำนวนคุณลักษณะ (ค่าเริ่มต้น: 1)
- `noise`: ระดับความรบกวนในข้อมูล (ค่าเริ่มต้น: 15.0)

## ตัวอย่างการใช้งาน

```python
from epoch_based_training import EpochBasedTraining

# สร้างโมเดล
model = EpochBasedTraining(learning_rate=0.1, epochs=50)

# เทรนโมเดล
model.fit(X, y)

# ทำนาย
y_pred = model.predict(X)

# แสดงผล
model.plot_loss_history()
model.plot_regression_line(X, y)
```

## การเปรียบเทียบจำนวน Epochs

สามารถเปรียบเทียบผลการเทรนด้วยจำนวน epochs ต่างๆ ได้:
```python
from run_demo import compare_epochs

# เปรียบเทียบ epochs = 10, 25, 50, 100, 200
results = compare_epochs(n_samples=100, 
                      n_features=1, 
                      noise=15.0, 
                      learning_rate=0.1)
```

## ข้อแนะนำในการใช้งาน

1. เลือกจำนวน epochs ที่เหมาะสม
   - เริ่มจากจำนวนน้อย (เช่น 10)
   - เพิ่มขึ้นจนกว่าค่าความสูญเสียจะไม่ลดลง

2. ปรับ learning rate ให้เหมาะสม
   - ค่ามากเกินไปอาจทำให้ไม่ลู่เข้า
   - ค่าน้อยเกินไปอาจใช้เวลานาน

3. ใช้ early stopping
   - หยุดเทรนเมื่อค่าความสูญเสียไม่ลดลง
   - ป้องกัน overfitting

4. ตรวจสอบการลู่เข้า
   - ดูกราฟประวัติค่าความสูญเสีย
   - เปรียบเทียบผลลัพธ์กับข้อมูลจริง 